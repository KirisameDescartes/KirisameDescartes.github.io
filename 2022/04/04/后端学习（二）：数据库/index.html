<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>后端学习（二）：数据库 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="二、数据库(database)（一）基本概念  概念：用于存储和管理数据的仓库 特点：持久化存储，实际上是一个文件系统；方便存储和管理；使用统一方式来操作 数据类型：int（整数类型） double(m,n)（小数类型,总共有m位，小数部分有n位）date（日期类型，只包含年月日） datetime（日期类型，包含年月日时分秒）timestamp（时间戳类型，如果不赋值，则默认用系统时间自动赋值）">
<meta property="og:type" content="article">
<meta property="og:title" content="后端学习（二）：数据库">
<meta property="og:url" content="http://example.com/2022/04/04/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%BA%93/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="二、数据库(database)（一）基本概念  概念：用于存储和管理数据的仓库 特点：持久化存储，实际上是一个文件系统；方便存储和管理；使用统一方式来操作 数据类型：int（整数类型） double(m,n)（小数类型,总共有m位，小数部分有n位）date（日期类型，只包含年月日） datetime（日期类型，包含年月日时分秒）timestamp（时间戳类型，如果不赋值，则默认用系统时间自动赋值）">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-04-04T07:33:38.533Z">
<meta property="article:modified_time" content="2022-04-04T07:58:24.455Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.1.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-后端学习（二）：数据库" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/04/04/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%BA%93/" class="article-date">
  <time class="dt-published" datetime="2022-04-04T07:33:38.533Z" itemprop="datePublished">2022-04-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      后端学习（二）：数据库
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>二、数据库(database)<br>（一）基本概念</p>
<ol>
<li>概念：用于存储和管理数据的仓库</li>
<li>特点：持久化存储，实际上是一个文件系统；方便存储和管理；使用统一方式来操作</li>
<li>数据类型：int（整数类型） double(m,n)（小数类型,总共有m位，小数部分有n位）<br>date（日期类型，只包含年月日） datetime（日期类型，包含年月日时分秒）<br>timestamp（时间戳类型，如果不赋值，则默认用系统时间自动赋值）<br>varchar(n)（字符串类型，n为字符串的最大长度）</li>
</ol>
<p>（二）MySQL的配置</p>
<ol>
<li>安装与卸载</li>
<li>配置<br>(1) 启动方式<br>① 手动<br>② 使用cmd命令行：services.msc，打开服务窗口；以管理员身份运行，net strat&#x2F;stop mysql<br>(2) 登录与退出<br>①登录：使用命令，mysql -u root -p，并输入密码<br>如果cmd无法识别mysql命令，可以在系统变量Path中添加环境变量（bin文件夹的路径）<br>如果是远程连接非本机的数据库，用-h+ip地址来指定<br>②退出：使用命令exit或quit</li>
<li>目录结构<br>(1) 安装目录<br>① bin：二进制的可执行文件，命令<br>② data：数据文件，日志文件<br>③ include：C语言的头信息<br>④ lib：jar包<br>⑤ share：错误信息<br>(2) 数据目录：数据库（文件夹）、表（文件）、数据</li>
</ol>
<p>(三) 操作方法</p>
<ol>
<li>SQL的概念：structed query language，定义了操作所有的关系型数据库的规则</li>
<li>通用语法<br>(1) 单行或多行书写，以分号结尾<br>(2) 使用空格或制表符提高可读性<br>(3) 不区分大小写<br>(4) 注释方法 ①单行注释：–或# ②多行注释：&#x2F;* *&#x2F;</li>
<li>分类<br>(1) DDL（数据定义语言）：用来定义数据库对象，操作数据库和表<br>(2) DML（数据操作语言）：增删改表中的数据<br>(3) DQL（数据查询语言）：查询表中的数据<br>(4) DCL（数据控制语言）：进行授权<br>A. DDL</li>
<li>操作数据库<br>(1) 创建 create+数据库名称;<br>后加if not exists+数据库名称 创建前检验是否存在同名数据库<br>后加character set+字符集名称 指定字符集<br>两个都用时为先判断再指定<br>(2) 删除 drop database+数据库名称<br>后加if exists+数据库名称 删除前检查是否存在该名数据库<br>(3) 修改 alter database 数据库名称 character set 字符集名称; 修改数据库的字符集<br>(4) 查询<br>① show databases; 查看所有的数据库<br>② show create database+数据库名称; 查询某个数据库的字符集<br>(5) 使用数据库<br>① use+数据库名称<br>② select database(); 查询正在使用的数据库</li>
<li>操作表<br>(1) 创建<br>① create table 表名(列名n 数据类型n，);（注意：最后一列不写逗号）<br>② create table 表名 like 表名; 复制表<br>(2) 删除 drop table 表名<br>后加if exists+表名称 删除前检查是否存在该名表<br>(3) 修改<br>&lt;1&gt; 整体<br>① alter table 表名 rename to 新表名; 表名修改<br>② alter table 表名 character set 字符集名称; 修改表的字符集<br>&lt;2&gt; 列<br>① alter table 表名 add 列名 数据类型; 添加新的列<br>② alter table 表名 change 列名 新列名 新的数据类型; 改列名<br>③ alter table 表名 modify 列名 新的数据类型; 修改列的数据类型<br>④ alter table 表名 drop 表名; 删除列<br>(4) 查询<br>① show tables; 查询数据库中的所有表<br>② desc+表名; 查询表结构<br>B. DML</li>
<li>添加数据 insert into 表名(列名1，……列名n) values(值1，……值n);<br>列名和值要一一对应；若不写列名，则默认给所有列添加值，数量也应与表统一；<br>除了数字类型，其他的要用引号引起来，单双引号都可以</li>
<li>删除数据<br>① delete from 表名 where 条件; 删除一条数据。如果不加条件，则会删除整个表的数据<br>② truncate table 表名; 删除表，然后再创建一个同样的空表</li>
<li>修改数据 update 表名 set 列名1&#x3D;值1，……列名n&#x3D;值n where条件;<br>若不加条件，则会将表中的数据都修改<br>C. DQL<br>(A) 单表查询</li>
<li>语法结构<br>select 字段列表 from 表名 where 条件列表<br>group by 分组字段 having 分组之后的条件<br>ordered by 排序条件 limit分页限定</li>
<li>基础查询<br>(1) 多字段查询<br>① select * from 表名; 查询表中所有数据<br>② select 字段列表 from 表名;<br>select name,age form student;<br>(2) 取出重复的结果集 在select后加distinct<br>(3) 对列中的值做计算 把计算表达式写入字段列表（English+Math）<br>if null(English,0) 如果字段列表中的某个值为Null，则被替换<br>在计算结构后加”as 别名”或” 别名”，可以使表头内容被替换</li>
<li>条件查询<br>(1) 方法：where 条件<br>(2) 条件类型<br>&lt;1&gt; 精确查询<br>①比较符 age&gt;20,age&#x3D;20,a&lt;&gt;20(不等于)<br>②betwen and;in;is null in(12,13,14)<br>③逻辑符<br>&lt;2&gt; 模糊查询 like “马%” 查询姓马的同学，_占一个字符，%占多个字符（可以为空）</li>
<li>排序查询<br>(1) 排序方式：ordered by 排序字段1 排序方式1,……排序字段n，排序方式n<br>asc 升序，dsc 降序<br>(2) 聚合函数：对一列中的数据做某种计算并显示，注意该函数自动排除null<br>select count(English) from table1; 统计English列中数据的个数<br>如果count中为*，则意味着只要一行数据中有一个不为null，就可以算一条记录</li>
<li>分组查询<br>group by 分组字段，只能查询分组字段和聚合函数<br>select sex,avg(math) from student group by sex;<br>如果在group by之前添加where条件，那么分组之前不符合条件的数据将不会参与分组<br>如果在group by之后添加having条件，那么分组之后不符合条件的数据将不会显示，且having可以用聚合函数的判断</li>
<li>分页查询<br>limit 开始的索引,每页查询的条数;<br>开始的索引&#x3D;（当前的页码-1）*每页的条数<br>（B）多表查询</li>
<li>特点：多表查询会产生无用的笛卡尔积，需要消除</li>
<li>内连接查询<br>(1) 隐式内连接：使用where条件来消除无用数据，描述条件时注意要说名表名，且可以设置别名<br>select 字段列表 from 左表 别名1,右表 别名2 where 条件;<br>(2) 显式内连接：select 字段列表 from 左表 别名1 join 右表 别名2 on 条件</li>
<li>外连接查询<br>(1) 左外连接：select 字段列表 from 左表 别名1 left join 右表 别名2 on 条件<br>(2) 右外连接：select 字段列表 from 左表 别名1 right join 右表 别名2 on 条件<br>查询出的是对应边的表加上交集</li>
<li>子查询（嵌套查询）<br>(1) 情况1-子查询的结果是单行单列的：此时结果可以作为条件，用where来判断<br>(2) 情况2-子查询的结果是多行单列的：此时结果也可作为条件，用in来判断<br>(3) 情况3-子查询的结果是多行多列的：此时结果可以作为虚拟表，用在多表查询中，可以被普通的呢连接替换<br>D. DCL</li>
<li>管理用户<br>(1) 查询用户：切换到MySQL数据库，并查询user表<br>(2) 创建用户：creat user ‘用户名‘@’主机名’ identified by ‘密码’;<br>如果在任意电脑上登录，则在主机名部分使用通配符%<br>(3) 删除用户：drop user ‘用户名‘@’主机名’;</li>
<li>修改用户密码<br>(1) 修改：update user set password&#x3D;password(‘新密码’) where user&#x3D;’用户名’; 或者<br>set password for ‘用户名‘@’主机名’ &#x3D;password(‘新密码’);<br>(2) 忘记root密码的解决办法<br>① 以管理员身份运行cmd，输入net stop mysql，停止MySQL的服务<br>② 使用无验证方式启动mysql服务<br>③ 修改root的密码<br>④ 结束无验证服务<br>⑤ 正常启动服务并登录</li>
<li>管理权限<br>(1) 查询权限：show grants for ‘用户名‘@’主机名’;<br>(2) 授予权限：grant 权限列表 on 数据库.表名 ‘用户名‘@’主机名’;<br>可以用all来代表所有权限，用*.*来代表所有库的所有表<br>(3) 撤销权限：revoke 权限列表 on 数据库.表名 from  ‘用户名‘@’主机名’;</li>
</ol>
<p>(四) 约束</p>
<ol>
<li>约束的概念：对表中的数据进行限定，保证数据的正确性，有效性和完整性</li>
<li>分类：主键约束，非空约束，唯一约束，外建约束<br>A. 非空约束</li>
<li>设置方式：在创建语句末加入not null；使用change或者modify</li>
<li>删除方式：使用change或者modify<br>B. 唯一的约束</li>
<li>设置方式：在创建语句末加入unique；使用change后者modify</li>
<li>删除方式：使用drop index，alter table stu drop index number<br>C. 主键约束</li>
<li>特点：非空且唯一；一个表只有一个字段为主键；主键是表中的唯一标识 （一般设置id等字段为主键）</li>
<li>设置方式：在创建语句末加入primary key；使用change或者modify；<br>如果设置的是联合主键，则单独写一行primary key(字段1，字段2)</li>
<li>删除方式：alter table stu drop primary key</li>
<li>自动增长<br>(1) 概念：如果某一列是数值类型，可以使用auto_increment来完成自动增长，一般配合int类型的主键来使用<br>(2) 使用方式：在创建语句中加入auto_increment，或者使用change、modify；<br>之后使用insert into来创建行时，可以将主键赋值为null，该列值会自动赋值为增长后的数值<br>(3) 删除方式：使用change或者modify<br>D. 外键约束</li>
<li>生效方式：让表与表产生关系，不能单独删除副表，同时也不能添加不在副表中的数值</li>
<li>设置外键：在创建表格时添加外键列，constraint 外键名称 foreign key 外键列名称 references 主表名称 关联列名称;<br>table 表名 add constraint 外键名称 foreign key 外键列名称 references 主表名称 关联列名称;</li>
<li>删除外键：alter table 表名 drop foreign key 外键名</li>
<li>级联操作<br>(1) 作用：使多个表产生联动，修改副表，主表被外键关联的部分也会产生相应的变化<br>(2) 设置方式：在创建外键时添加on update cascade，设置级联更新；on delete cascade，设置级联删除</li>
</ol>
<p>（五）数据库的设计<br>A. 多表关系<br>分类：一对一，一对多，多对多</p>
<ol>
<li>一对多关系：设置方式为添加外键，在多的一方建立外键，指向一的地方的主键</li>
<li>多对多关系：需要借助中间表，在中间表中设置外键，分别指向两张主表的主键</li>
<li>一对一关系：可以在任意一方添加唯一外键指向另一方的主键<br>B. 范式<br>概念：在设置数据库时需要遵循的一些规范</li>
<li>第一范式：每一列都是不可分割的原子数据项，即不存在复合列</li>
<li>第二范式：在1NF的基础上，非码属性必须完全依赖于候选码，即消除部分依赖，解决方式为表的拆分</li>
<li>第三范式：在2NF的基础上，任何非主属性不依赖与其他非主属性，即消除传递依赖，解决方法为表的拆分</li>
</ol>
<p>（六）事务</p>
<ol>
<li>概念：事务管理多个业务操作中的步骤，要么同时成功，要么同时失败</li>
<li>操作：开启、回滚和提交<br>(1) 提交方式有两种，为自动提交和手动提交。自动提交为每输入一次DML语句，则MySQL会自动提交；手动提交需要先开启事务（start transaction）<br>(2) 修改默认提交方式：set @@autocommit&#x3D;0 &#x2F; 1</li>
<li>事务的特征<br>(1) 原子性：不可再分割<br>(2) 持久性：如果事务一旦提交或回滚，将会永久更新数据库中的数据<br>(3) 隔离性：多个事务之间相互独立<br>(4) 一致性：事务操作前后，数据总量不变</li>
<li>事务的隔离级别<br>(1) 用途：防止操作同一批数据的事务互相影响<br>(2) 存在问题<br>① 脏读：读到另一个事务中没有提交的数据<br>② 不可重复读（虚读）：在同一个事务中，两次读取到的数据不一样<br>③ 幻读：一个事务操作数据表中的所有数据，另一个数据添加了一条数据，则第一个事务查询不到自己的修改<br>(3) 级别类型<br>① read uncommited：三种问题都会发生<br>② read commited：会发生后两种，即为另一个事务只会读取一个事务已提交的数据<br>③ repeatable read（可重复读）：会发生幻读<br>在此种级别下，一次未提交事务中多次查询到的数据是相同的，无论另一个事务是否对数据做出了实质性修改<br>④ serializable（串行化）：可以解决所有问题<br>在此种级别下，一个事务操作数据时，另一个事务不可操作，只有提交或回滚后另一个才能进行<br>注意：这些级别安全性越来越高，但效率越来越低，没有特殊需求就不需要修改隔离级别<br>(4) 查看与设置隔离级别<br>select @@tx_isolation; 查看<br>select global transaction isolation level 级别; 设置</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/04/04/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%BA%93/" data-id="cl1kekw6v0002w0uye5ovgbtt" data-title="后端学习（二）：数据库" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/04/04/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AJDBC/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          后端学习（三）：JDBC
        
      </div>
    </a>
  
  
    <a href="/2022/04/04/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E5%89%8D%E7%BD%AE%E5%86%85%E5%AE%B9/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">后端学习（一）：前置内容</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/04/04/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AJDBC/">后端学习（三）：JDBC</a>
          </li>
        
          <li>
            <a href="/2022/04/04/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%BA%93/">后端学习（二）：数据库</a>
          </li>
        
          <li>
            <a href="/2022/04/04/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E5%89%8D%E7%BD%AE%E5%86%85%E5%AE%B9/">后端学习（一）：前置内容</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>